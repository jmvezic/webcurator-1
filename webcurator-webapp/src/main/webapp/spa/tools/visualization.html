<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">

  <title>Target Instance</title>
  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="../dist/font/fontawesome-free.min.css">
<!--  <link rel="stylesheet" href="../dist/bootstrap/4.4.1/css/bootstrap.min.css">-->
  <link rel="stylesheet" href="../dist/adminlte/css/adminlte.min.css">
  <link rel="stylesheet" href="../dist/fancytree/skin-win8/ui.fancytree.min.css">
  <!-- <link rel="stylesheet" href="../dist/fancytree/modules/plain-scrollbar.css"> -->
  <link rel="stylesheet" href="../dist/jquery/menu/jquery.contextMenu.css">
  <!-- <link rel="stylesheet" href="../dist/plugins/datetimepicker-bootstrap-4.min.css"> -->
  <!-- <link rel="stylesheet" href="../dist/plugins/tempusdominus-bootstrap-4.min.css"> -->
  <link rel="stylesheet" href="../dist/ag-grid/ag-grid.css">
  <link rel="stylesheet" href="../dist/ag-grid/ag-theme-balham.css">
  <link rel="stylesheet" href="../dist/ag-grid/ag-theme-balham-dark.css">
  <link rel="stylesheet" href="visualization.css">
</head>
<!--
BODY TAG OPTIONS:
=================
Apply one or more of the following classes to to the body tag
to get the desired effect
|---------------------------------------------------------|
|LAYOUT OPTIONS | sidebar-collapse                        |
|               | sidebar-mini                            |
|---------------------------------------------------------|
-->
<body unselectable="on" class="layout-navbar-fixed sidebar-collapse">
<div class="wrapper">
  <nav class="main-header navbar navbar-expand navbar-white" style="padding: 0;">
    <!-- Left navbar links -->
    <ul class="navbar-nav">
      <!-- View -->
      <li class="nav-item dropdown">
        <a class="nav-link" data-toggle="dropdown" href="#">
          <i class="fas fa-eye"> Inspect</i>
          <!-- <span class="badge badge-warning navbar-badge hidden" id="derived-hr-badge">0</span> -->
        </a>
        <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
          <span class="dropdown-item dropdown-header">Inspect Views</span>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <i class="fas fa-vector-square"></i> 
            <span class="float-right text-muted text-sm">Network Map</span>
          </a>
          <a href="#" class="dropdown-item">
            <i class="fas fa-bezier-curve"></i>
            <span class="float-right text-muted text-sm">Harvest Struct</span>
          </a>
          <a href="#" class="dropdown-item">
            <i class="fab fa-fedora"></i>
            <span class="float-right text-muted text-sm">URL Names</span>
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <i class="fas fa-search"></i>
            <span class="float-right text-muted text-sm">Query</span>
          </a>
        </div>
      </li>

      <!-- Prune and Import -->
      <li class="nav-item dropdown">
        <a class="nav-link" data-toggle="dropdown" href="#">
          <i class="fab fa-buffer"> Operation</i>
        </a>
        <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
          <span class="dropdown-item dropdown-header">Operation</span>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <i class="fas fa-times-circle"></i> 
            <span class="float-right text-muted text-sm">Bulk Prune</span>
          </a>
          <a href="#" class="dropdown-item">
            <i class="fas fa-cloud-upload-alt"></i>
            <span class="float-right text-muted text-sm">Bulk Import</span>
          </a>
          <a href="#" class="dropdown-item">
            <i class="fas fa-file-upload"></i>
            <span class="float-right text-muted text-sm">Single Import</span>
          </a>
        </div>
      </li>
    </ul>


    <!-- Right navbar links -->
    <ul class="navbar-nav ml-auto">
      <li class="nav-item d-none d-sm-inline-block">
        <a onclick="$('#popup-window-modify-harvest').show();" class="nav-link">Modify</a>
      </li>

      <!-- Derived Harvest Results -->
      <li class="nav-item dropdown">
        <a class="nav-link" data-toggle="dropdown" href="#" onclick="updateDerivedHarvestResults();">
          <i class="far fa-folder-open"></i>
          <!-- Derived -->
          <span class="badge badge-warning navbar-badge hidden" id="derived-hr-badge">0</span>
        </a>
        <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right" id="derived-hr-list">
          <span class="dropdown-item dropdown-header">Derived Harvest Results</span>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <i class="fas fa-external-link-square-alt"></i> 1
            <span class="float-right text-muted text-sm">Summary</span>
          </a>
        </div>
      </li>


      <li class="nav-item">
        <a onclick="toggleScreenSize();" role="button" class="nav-link btn-full-screen"><i class="fas fa-expand"></i></a>
      </li>
      <li class="nav-item">
        <a onclick="gParentHarvestResultViewTab.closeContentWindow();" role="button" class="nav-link"><i class="fas fa-times"></i></a>
      </li>
    </ul>
  </nav> <!-- End of Header -->
</div>


<!-- Network Map -->
<div class="main-tab hidden" name="networkmap">
    <!-- Networmap Canvas -->
    <div id="network-map-canvas" style="height: 100%; width: calc(100% - 395px); margin-left: 395px;"></div>

    <div class="card" style="position: absolute; left: 1px; bottom: 0px; width: 400px; height: calc(100% - 40px); margin: 0; padding: 0;">
      <div class="card-header">
        <h3 class="card-title">Catagory</h3>
        <div class="card-tools">
          <button type="button" class="btn btn-tool btn-side-group-type text-primary" name="statuscode">Status</button>
          <button type="button" class="btn btn-tool btn-side-group-type" name="contenttype">Type</button>
        </div>
      </div>
      <div class="card-body" style="margin: 0; padding: 0;">
         <!-- Side Card -->
        <div id="networkmap-side-container" style="height: 100%; width: 100%;">
          <div class="networkmap-insight ag-theme-balham" id="networkmap-side-table-group-by-status-code"> </div>
          <div class="networkmap-insight ag-theme-balham hidden" id="networkmap-side-table-group-by-content-type"> </div>
        </div> <!-- end of side card -->
      </div> <!-- end of card body -->
    </div> <!-- end of card -->

    <div style="position: absolute; left: 450px; top: 55px; margin: 0; padding: 0;">
      <h3 class="text-info">Current Domain: <span class="text-success" id="networkmap-side-title">Root</span></h3>
    </div>

    <div style="position: absolute; right: 5px; top: 55px; margin: 0; padding: 0;">
      <div class="btn-group">
        <button type="button" class="btn btn-default" onclick="networkmap.graph.reload();">Reload</button>
        <button type="button" class="btn btn-default" onclick="networkmap.graph.collapseAll();">Collapse</button>
      </div>
    </div>
</div>


<!-- TreeView: Harvest Struct -->
<div class="main-tab hidden" name="tree-harvest-struct">
  <div>&nbsp;</div><div>&nbsp;</div>
  <div style="width: 100vw; height: calc(100vh - 50px); overflow-x: hidden; overflow-y: scroll;">
      <table id="hierachy-tree-harvest-struct" style="width: 100%; outline: none;">
        <colgroup>
            <col width="50px">
            <col width="*">
            <col width="80px">
            <col width="80px">
            <col width="80px">
            <col width="80px">
            <col width="80px">
            <col width="80px">
            <col width="80px">
        </colgroup>
        <thead>
        <tr>
            <th>Action</th>
            <th>URL</th>
            <th>Type</th>
            <th>Status</th>
            <th>Size</th>
            <th>URLs</th>
            <th>Success</th>
            <th>Failed</th>
            <th>TotSize</th>
        </tr>
        </thead>
    </table>
  </div>
</div>


<!-- TreeView: URL Names -->
<div class="main-tab" name="tree-url-names">
  <div>&nbsp;</div><div>&nbsp;</div>
  <div style="width: 100vw; height: calc(100vh - 50px); overflow-x: hidden; overflow-y: scroll;">
      <table id="hierachy-tree-url-names" style="width: 100%; outline: none;">
        <colgroup>
            <col width="50px">
            <col width="*">
            <col width="80px">
            <col width="80px">
            <col width="80px">
            <col width="80px">
            <col width="80px">
            <col width="80px">
            <col width="80px">
        </colgroup>
        <thead>
        <tr>
            <th>Action</th>
            <th>URL</th>
            <th>Type</th>
            <th>Status</th>
            <th>Size</th>
            <th>URLs</th>
            <th>Success</th>
            <th>Failed</th>
            <th>TotSize</th>
        </tr>
        </thead>
    </table>
  </div>
</div>

<!-- Query Grid -->
<div class="main-tab" name="tree-url-names">
  <div>&nbsp;</div><div>&nbsp;</div>

</div>

<!-- Popup window for inspection and modification -->
<div class="card none-margin-padding bg-light"  id="popup-window-modify-harvest">
  <div class="card-body none-margin-padding">
      <nav class="main-header navbar navbar-expand" style="padding: 0;">
          <!-- Left navbar links -->
          <ul class="navbar-nav">
            <li class="nav-item">
              <input class="form-control" type="search" placeholder="Filter" aria-label="Search" for="candidateGrid">
            </li>

            <li class="nav-item" style="margin-left: 10px;">
              <div class="btn-group">
                <button type="button" class="btn btn-primary dropdown-toggle dropdown-icon" data-toggle="dropdown">
                  Action
                  <span class="sr-only">Toggle Dropdown</span>
                  <div class="dropdown-menu" role="menu">
                    <a class="dropdown-item" href="#" onclick="$('#popup-window-query-input').show();"><i class="fas fa-search"></i> &nbsp; Inspect By Query</a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="#" onclick="gPopupModifyHarvest.loadSeedUrls();"><i class="fas fa-link text-primary"></i> &nbsp;Inspect Starting URLs</a>
                    <a class="dropdown-item" href="#" onclick="gPopupModifyHarvest.loadInvalidUrls();"><i class="fas fa-link text-warning"></i> &nbsp;Inspect Invalid URLs</a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="#" onclick="gPopupModifyHarvest.showBulkPrune();"><i class="far fa-times-circle text-secondary"></i> &nbsp; Bulk Prune</a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="#" onclick="gPopupModifyHarvest.showImport();"><i class="fas fa-file-import text-primary"></i> &nbsp; Single Import</a>
                    <a class="dropdown-item" href="#" onclick="gPopupModifyHarvest.showBulkImport();"><i class="fas fa-file-import text-warning"></i> &nbsp; Bulk Import</a>
                    <!-- <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="#" onclick="gPopupModifyHarvest.loadSeedUrls();"><i class="fas fa-file-upload text-success"></i> &nbsp;Upload File</a> -->
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="#" onclick="gPopupModifyHarvest.gridCandidate.clearAll();"><i class="far fa-trash-alt"></i> &nbsp; Clear</a>
                  </div>
                </button>
              </div>
            </li>
            
          </ul>
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <div class="btn-group btn-nav-tab">
                <button type="button" class="btn btn-primary" for="prune" id="tab-btn-prune">To Be Pruned</button>
                <button type="button" class="btn btn-outline-primary" for="import" id="tab-btn-import">To Be Imported</button>
              </div>
            </li>               
            <li class="nav-item">
              <a onclick="toggleScreenSize();" role="button" class="nav-link btn-full-screen"><i class="fas fa-expand"></i></a>
            </li>
            <li class="nav-item">
              <a onclick="$('#popup-window-modify-harvest').hide();" role="button" class="nav-link"><i class="fas fa-times"></i></a>
            </li>
          </ul>
      </nav>

      <div class="row">
        <div class="col-7">
          <div class="tab-content">
            <div id="grid-modify-candidate" class="ag-theme-balham grid-modify-harvest"> </div>
            <div id="popup-window-hierarchy" class="card hidden" style="height: 100%;">
              <div class="card-header">
                <h3 class="card-title">Outlinks Tree</h3>
                <div class="card-tools">
                  <button type="button" class="btn btn-tool" data-card-widget="remove" onclick="javascript: $('#popup-window-hierarchy').hide(); $('#grid-modify-candidate').show();"><i class="fas fa-times"></i>
                  </button>
                </div>
                <!-- /.card-tools -->
              </div>
              <!-- /.card-header -->
              <div class="card-body" style="height: calc(100% - 30px);">
                <div class="fixed-size">
                  <table id="hierachy-tree" style="width: 70vw; outline: none;">
                      <colgroup>
                          <col width="50px">
                          <col width="*">
                          <col width="80px">
                          <col width="80px">
                          <col width="80px">
                          <col width="80px">
                          <col width="80px">
                          <col width="80px">
                          <col width="80px">
                      </colgroup>
                      <thead>
                      <tr>
                          <th>Action</th>
                          <th>URL</th>
                          <th>Type</th>
                          <th>Status</th>
                          <th>Size</th>
                          <th>URLs</th>
                          <th>Success</th>
                          <th>Failed</th>
                          <th>TotSize</th>
                      </tr>
                      </thead>
                  </table>
                </div>
              </div>
              <!-- /.card-body -->
            </div>
            <!-- /.card -->
          </div>

        </div>
        <div class="col-5">


          <div class="tab-content" id="grid-tobe-modified">
            <div id="grid-modify-prune" class="ag-theme-balham grid-modify-harvest"> </div>
            <div id="grid-modify-import" class="ag-theme-balham grid-modify-harvest hidden"> </div>
          </div>

        </div>
      </div>

      <div class="input-group" style="margin: 5px 2px 0 2px; width: calc(100% - 4px);">
        <textarea id="provenance-note" class="form-control" rows="1"  placeholder="Provenance Note ..."></textarea>
      </div>
  </div>  <!-- End of card body -->

  <div class="card-footer">
    <div class="row">
      <div class="col-10"></div>
      <div class="col-1">
          <button type="button" class="btn btn-block btn-primary" onclick="gPopupModifyHarvest.apply();">Apply</button>
      </div>
      <div class="col-1">
          <button type="button" class="btn btn-block btn-secondary" onclick="$('#popup-window-modify-harvest').hide();">Close</button>
      </div>
    </div>
  </div>
</div> 


<!-- Popup Hop Path-->
<div class="popup-window" id="popup-window-hop-path">
<div class="card card-primary popup-content">
  <div class="card-header">
    <h3 class="card-title">Hop Path</h3>

    <div class="card-tools">
      <button type="button" class="btn btn-tool" onclick="$('#popup-window-hop-path').hide();"><i class="fas fa-times"></i>
      </button>
    </div>
    <!-- /.card-tools -->
  </div>
  <!-- /.card-header -->
  <div class="card-body none-margin-padding"  id="hoppath-canvas" style="background: white; height: calc(100% - 50px);">
  </div>   <!-- /.card-body -->
</div> <!-- /.card -->
</div>

<!-- Popup Single Import Input-->
<div class="popup-window" id="popup-window-single-import">
<div class="card card-primary popup-content">
  <div class="card-header">
    <h3 class="card-title">Single Import (<span id="single-impot-mode">New</span>)</h3>
    <div class="card-tools">
      <button type="button" class="btn btn-tool" onclick="$('#popup-window-single-import').hide();"><i class="fas fa-times"></i></button>
    </div>
    <!-- /.card-tools -->
  </div>
  <!-- /.card-header -->
  <div class="card-body" style="margin: 5px; padding: 5px 5px 0 5px; background-color: white;">
        <div class="form-group">
          <label for="specifyTargetUrlInput">Specify Target URL</label>
          <input type="input" class="form-control" id="specifyTargetUrlInput" placeholder="Specify Target URL">
        </div>
  </div>

  <div class="card-body" style="margin: 5px; padding: 5px 5px 0 5px; background-color: white;" id="card-body-source">
        <div class="form-group">
          <!-- <label for="importFromFileInput">Import from disk file</label> -->
          <div class="custom-control custom-radio">
            <input class="custom-control-input" type="radio" id="customRadio1" name="customRadio" flag="File" checked>
            <label for="customRadio1" class="custom-control-label">Option 1: Re-crawl from disk file</label>
          </div>
          <div class="input-group">
            <div class="custom-file">
              <input type="file" class="custom-file-input" id="sourceFile" name="sourceFile">
              <label class="custom-file-label" for="sourceFile" id="label-source-file">Choose file</label>
            </div>
            <div class="input-group-append">
              <!-- <span class="input-group-text" id="">Upload</span> -->
              <!-- <input type="submit" value="import" id="submit"/> -->
            </div>
          </div>
          <br/>
          
          <div class="form-group clearfix" id="radio-group-modified-date">
            <label for="radio-group-modified-date">Modified Datetime</label>
            <div class="custom-control custom-radio d-inline">
              <input type="radio" id="radioModifiedDateModeTbc" name="r1" flag="TBC" checked>
              <label for="radioModifiedDateModeTbc" style="font-weight: normal;">TBC</label>
            </div>
            <div class="custom-control custom-radio d-inline">
              <input type="radio" id="radioModifiedDateModeFile" name="r1" flag="File">
              <label for="radioModifiedDateModeFile" style="font-weight: normal;">File Modified Time</label>
            </div>
            <div class="custom-control custom-radio d-inline">
              <input type="radio" id="radioModifiedDateModeCustom" name="r1" flag="CUSTOM">
              <label for="radioModifiedDateModeCustom" style="font-weight: normal;">Custom</label>
              <input type="datetime-local" id="datetime-local-customizard">
            </div>
            <!-- <div class="custom-control d-inline"  style="width: 12vw;">
              <input type="datetime-local" id="datetime-local-customizard">
            </div>   -->          
          </div>
        </div>
  </div>
  
  <div class="card-body" style="margin: 5px; padding: 5px 5px 0 5px; background-color: white;" id="card-body-modified-date">
        <div class="custom-control custom-radio">
          <input class="custom-control-input" type="radio" id="customRadio2" name="customRadio" flag="URL">
          <label for="customRadio2" class="custom-control-label">Option 2: Re-crawl from URL</label>
        </div>
        <div class="custom-control">
          <label class="text-secondary">Source URL: the same as Target URL</label>
          <!-- <input type="input" class="form-control" id="importFromUrlInput" placeholder="Source URL">
          <div class="input-group-append">
            <span class="input-group-text" onclick="useTargetURL();">Use Target URL</span>
          </div> -->
        </div>
        <br/>
  </div>  <!-- /.card-body -->

  <div class="card-footer">
    <div class="row">
      <div class="col-8">
        <div class="custom-control custom-checkbox">
          <input class="custom-control-input" type="checkbox" id="checkbox-prune-of-single-import" checked>
          <label for="checkbox-prune-of-single-import" class="custom-control-label">Prune the existing content when exist</label>
        </div>
      </div>
      <div class="col-2">
          <!-- <button type="button" class="btn btn-block btn-primary" onclick="spPrunedImported($('#tab-btn-import'));">Import</button> -->
          <button type="button" class="btn btn-block btn-primary" onclick="gPopupModifyHarvest.processorModify.singleImport();">Re-crawl</button>
          <!-- <input type="submit" value="Re-crawl" class="btn btn-block btn-primary" id="submit"/> -->
      </div>
      <div class="col-2">
          <button type="button" class="btn btn-block btn-secondary" onclick="$('#popup-window-single-import').hide();">Close</button>
      </div>
    </div>
  </div>
</div> <!-- /.card -->
</div>


<!-- Popup Bulk Import-->
<div class="popup-window" id="popup-window-bulk-import">
<div class="card card-primary popup-content">
  <div class="card-header">
    <h3 class="card-title">Bulk Import</h3>
    <div class="card-tools"><button type="button" class="btn btn-tool" onclick="$('#popup-window-bulk-import').hide();"><i class="fas fa-times"></i></button></div>
    <!-- /.card-tools -->
  </div>  <!-- /.card-header -->
  <div class="card-body">
    <div class="tab-bulk-import" id="tab-bulk-import-0">
      <p> You could download a <a href="/spa/tools/bulk-import-template.csv">Template</a> from here.</p>
      <div class="form-group">
        <label for="specifyTargetUrlInput">Please upload a METADATA file:</label>
        <div class="custom-file">
          <input type="file" class="custom-file-input" id="bulkImportMetadataFile">
          <label class="custom-file-label" for="bulkImportMetadataFile" id="label-bulk-import-metadata-file">Choose file</label>
        </div>
      </div>
      <div class="form-group">
        <label>Column separator:</label>
        <select class="custom-select" id="bulk-import-column-separator">
          <option>Tab</option>
          <option>,</option>
          <option>|</option>
        </select>
      </div>
    </div>


    <div class="tab-bulk-import hidden" id="tab-bulk-import-1">
      <div id="grid-bulk-import-prepare" class="ag-theme-balham grid-modify-harvest" style="width: 100%; height: 30vh;"> </div>
      <br/>
      <p id="tip-bulk-import-prepare">All rows are valid.</p>
      <p id="tip-bulk-import-prepare-invalid" class="hidden">Please upload relevant files <a href="javascript:$('#bulkImportContentFile').trigger('click');">Choose content files</a></p>


      <input type="file" class="hidden" id="bulkImportContentFile" onchange="gPopupModifyHarvest.processorModify.bulkUploadFiles();" multiple>
    </div>

  </div>  <!-- /.card-body -->

  <div class="card-footer">
    <div class="row">
      <div class="col-8">
        <div class="custom-control custom-checkbox">
          <input class="custom-control-input" type="checkbox" id="checkbox-prune-of-bulk-import" checked>
          <label for="checkbox-prune-of-bulk-import" class="custom-control-label">Prune the existing content when exist</label>
        </div>
      </div>
      <div class="col-2">
          <button type="button" class="btn btn-block btn-primary" id="btn-bulk-import-submit" step="0">Next</button>
      </div>
      <div class="col-2">
          <button type="button" class="btn btn-block btn-secondary" onclick="$('#popup-window-bulk-import').hide();">Close</button>
      </div>
    </div>
  </div>

</div> <!-- /.card -->
</div>


<!-- Popup Bulk Prune-->
<div class="popup-window" id="popup-window-bulk-prune">
<div class="card card-primary popup-content">
  <div class="card-header">
    <h3 class="card-title">Bulk Prune</h3>
    <div class="card-tools"><button type="button" class="btn btn-tool" onclick="$('#popup-window-bulk-prune').hide();"><i class="fas fa-times"></i></button></div>
    <!-- /.card-tools -->
  </div>  <!-- /.card-header -->
  <div class="card-body">
      <p> You could download a <a href="/spa/tools/bulk-prune-template.csv">Template</a> from here.</p>
      <div class="form-group">
        <label for="specifyTargetUrlInput">Please upload a METADATA file:</label>
        <div class="custom-file">
          <input type="file" class="custom-file-input" id="bulkPruneMetadataFile">
          <label class="custom-file-label" for="bulkPruneMetadataFile" id="label-bulk-prune-metadata-file">Choose file</label>
        </div>
      </div>
      <div class="form-group">
        <div class="custom-control custom-checkbox">
          <input class="custom-control-input" type="checkbox" id="checkbox-ignore-invalid-prune-urls">
          <label for="checkbox-ignore-invalid-prune-urls" class="custom-control-label">Ignore invalid URLs to be pruned</label>
        </div>
      </div>
      <div class="form-group">
        <div class="custom-control custom-checkbox">
          <input class="custom-control-input" type="checkbox" id="checkbox-ignore-duplicated-prune-urls" checked>
          <label for="checkbox-ignore-duplicated-prune-urls" class="custom-control-label">Ignore duplicated URLs to be pruned</label>
        </div>
      </div>
  </div>  <!-- /.card-body -->

  <div class="card-footer">
    <div class="row">
      <div class="col-8"></div>
      <div class="col-2">
          <button type="button" class="btn btn-block btn-primary" onclick="gPopupModifyHarvest.processorModify.bulkPrune();">Prune</button>
      </div>
      <div class="col-2">
          <button type="button" class="btn btn-block btn-secondary" onclick="$('#popup-window-bulk-prune').hide();">Close</button>
      </div>
    </div>
  </div>

</div> <!-- /.card -->
</div>



<!-- Popup Query Input-->
<div class="popup-window" id="popup-window-query-input">
<div class="card card-primary popup-content">
  <div class="card-header">
    <h3 class="card-title">Query URLs</h3>
    <div class="card-tools">
      <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-times"></i></button>
    </div>
    <!-- /.card-tools -->
  </div>
  <!-- /.card-header -->
  <div class="card-body">
    <div class="form-group">
      <label for="queryDomainName">Domain Name:</label>
      <input type="input" class="form-control" id="queryDomainName" placeholder="Key words of Domain Name, multiple key words divided by ','">
    </div>

    <div class="form-group">
      <label for="queryUrlName">URL Name:</label>
      <input type="input" class="form-control" id="queryUrlName" placeholder="Key words of URL Name, multiple key words divided by ','">
    </div>

    <div class="form-group">
      <label for="queryStatusCode">Status Code:</label>
      <input type="input" class="form-control" id="queryStatusCode" placeholder="Key words of Status Code, multiple key words divided by ','">
    </div>

    <div class="form-group">
      <label for="queryContentType">Content Type:</label>
      <input type="input" class="form-control" id="queryContentType" placeholder="Key words of Content Type, multiple key words divided by ','">
    </div>
  </div>  <!-- /.card-body -->

  <div class="card-footer">
    <div class="row">
      <div class="col-8">
      </div>
      <div class="col-2">
          <button type="button" class="btn btn-block btn-primary" onclick="gPopupModifyHarvest.queryHarvest();">Query</button>
          </div>
      <div class="col-2">
          <button type="button" class="btn btn-block btn-secondary" onclick="$('#popup-window-query-input').hide();">Close</button>
      </div>
    </div>
  </div>
  <!-- <div class="card-footer" style="width: 100%; position: absolute; bottom: 0;">
  </div> -->

</div> <!-- /.card -->
</div>


<div class="popup-window" id="popup-window-derived-summary">
<div class="card card-primary popup-content">
  <div class="card-header">
    <h3 class="card-title">Summary</h3>

    <div class="card-tools">
      <button type="button" class="btn btn-tool btn-full-screen" onclick="toggleScreenSize();"><i class="fas fa-expand"></i>
      </button>

      <button type="button" class="btn btn-tool" onclick="$('#popup-window-derived-summary').hide();"><i class="fas fa-times"></i>
      </button>

    </div>
    <!-- /.card-tools -->
  </div>
  <!-- /.card-header -->
  <div class="card-body none-margin-padding" id="body-derived-summary" style="background: white; height: calc(100vh - 55px); width: 100vw; overflow-y: auto; overflow-x: hidden;">
  </div>   <!-- /.card-body -->
</div> <!-- /.card -->
</div>


<div id="popup-window-loading">
  <div class="spin-overlay"><i class="fas fa-circle-notch text-default"></i></div>
</div>

<!-- Progress bar of indexing -->
<div id="popup-window-progress">
  <div style="margin-top: 45vh;">
    <div style="width: 100%; text-align: center;">Indexing: <span id="progressIndexerValue">0</span>%</div>
    <progress value="0" max="100" data-label="0% Complete" id="progressIndexer"></progress>
  </div>
</div>



<script src="../dist/jquery/jquery-3.4.1.min.js"></script>
<!-- <script src="../dist/jquery/require.js"></script> -->
<script src="../dist/bootstrap/bootstrap.bundle.min.js"></script>
<script src="../dist/plugins/bs-custom-file-input.min.js"></script>
<script src="../dist/adminlte/js/adminlte.js"></script>
<script src="../dist/vis/vis-network.js"></script>
<script src="../dist/fancytree/jquery.fancytree-all-deps.min.js"></script>
<script src="../dist/fancytree/modules/jquery.fancytree.table.js"></script>
<script src="../dist/fancytree/modules/jquery.fancytree.wide.js"></script>
<!-- <script src="../dist/fancytree/modules/jquery.fancytree.filter.js"></script> -->
<!-- <script src="../dist/fancytree/modules/plain-scrollbar.js"></script> -->
<script src="../dist/fancytree/modules/jquery.fancytree.logger.js"></script>
<!-- <script src="../dist/chartjs/Chart.js"></script> -->
<script src="../dist/jquery/menu/jquery.contextMenu.js"></script>
<script src="../dist/jquery/menu/jquery.ui.position.js"></script>
<script src="../dist/ag-grid/ag-grid-community.js"></script>
<!-- <script src="../dist/google/loader.js"></script> -->
<!-- <script src="../dist/d3/d3.js"></script> -->
<script src="../dist/plugins/moment-with-locales.min.js"></script>
<script src="../dist/plugins/moment-timezone-with-data-2012-2022.min.js"></script>
<!-- <script src="../dist/plugins/datetimepicker-bootstrap-4.min.js"></script> -->
<!-- <script src="../dist/plugins/tempusdominus-bootstrap-4.min.js"></script> -->
<script src="visualization.js"></script>
<script src="networkmap-graph.js"></script>
<script src="networkmap-grid.js"></script>
<script src="networkmap-menumap.js"></script>
<!-- <script src="networkmap-sunburst.js"></script> -->
<script src="networkmap.js"></script>
<script src="popup-modify-harvest-processor.js"></script>
<script src="popup-modify-harvest.js"></script>
<script src="popup-hop-path.js"></script>
<script src="url-browse.js"></script>

<script>
    // $('#popup-window-loading').show();
    var urlParameters=getUrlVars();
    var jobId=parseInt(urlParameters["targetInstanceOid"]);
    var harvestResultId=parseInt(urlParameters["harvestResultId"]);
    var harvestResultNumber=parseInt(urlParameters["harvestNumber"]);

    var visHopPath=new HopPath('hoppath-canvas', jobId, harvestResultNumber);
    var networkmap=new NetworkMap();
    var gPopupModifyHarvest=new PopupModifyHarvest(jobId, harvestResultId, harvestResultNumber);
    // var hierarchyTree=new HierarchyTree("#hierachy-tree-harvest-struct", jobId, harvestResultNumber);
    
    console.log(parent);
    var gParentHarvestResultViewTab=parent;
    var isToFullScreen=false;
    function toggleScreenSize(){
      console.log(isToFullScreen);
      if(!gParentHarvestResultViewTab || !gParentHarvestResultViewTab.toggleContentWindowSize){
        console.log('gParentHarvestResultViewTab is null');
        return;
      }
      gParentHarvestResultViewTab.toggleContentWindowSize(isToFullScreen);

      if(isToFullScreen){
        $('.btn-full-screen').html('<i class="fas fa-compress"></i>');
      }else{
        $('.btn-full-screen').html('<i class="fas fa-expand"></i>');
      }

      isToFullScreen=!isToFullScreen;
    }

    $(function(){
        console.log(parent);
        
        toggleScreenSize();

        updateDerivedHarvestResults();

        bsCustomFileInput.init();

        // document.addEventListener('contextmenu', event => event.preventDefault());
        sp("networkmap");
        
        networkmap.init(jobId, harvestResultNumber);
      
        gPopupModifyHarvest.initTreeWithSeedUrls();
        gPopupModifyHarvest.initTreeWithDomains();

        $("input[name=search]").on("change search", function(e){
          var n,
            tree = $.ui.fancytree.getTree(),
            match = $.trim($(this).val());

          // Pass a string to perform case insensitive matching
          n = tree.filterNodes(match, { mode: "hide" });
          $("span.matches").text(n ? "(" + n + " matches)" : "");
        });

        $('.btn-side-group-type').on('click', function(e){
          var name=$(this).attr('name');
          if(name==='statuscode'){
            $('#networkmap-side-table-group-by-status-code').show();
            $('#networkmap-side-table-group-by-content-type').hide();            
          }else{
            $('#networkmap-side-table-group-by-status-code').hide();
            $('#networkmap-side-table-group-by-content-type').show();            
          }

          $('.btn-side-group-type').removeClass('text-primary');
          $(this).addClass('text-primary');
          $('#networkmap-side-container').show();
        });

        $(".btn-nav-tab button").on("click", function(e){
          $(".btn-nav-tab button").removeClass("btn-primary");
          $(".btn-nav-tab button").addClass("btn-outline-primary");
          $(this).removeClass("btn-outline-primary");
          $(this).addClass("btn-primary");

          var tab=$(this).attr("for");
          $("#grid-tobe-modified .grid-modify-harvest").hide();
          $("#grid-modify-"+tab).show();
        });

        // Search input filter
        $("#popup-window-modify-harvest input[type='search']").on('input', function(e){
          var val=$(this).val();
          gPopupModifyHarvest.gridPrune.filter(val);
          gPopupModifyHarvest.gridImport.filter(val);
          gPopupModifyHarvest.gridCandidate.filter(val);
          gPopupModifyHarvest.hierarchyTree.filter(val);
          // var key=$(this).attr('for');
          // var target;
          // if(key==='prune'){
          //   target=gPopupModifyHarvest.gridPrune;
          // }else if(key==='import'){
          //   target=gPopupModifyHarvest.gridImport;
          // }else if(key==='candidateGrid'){
          //   target=gPopupModifyHarvest.gridCandidate;
          // }else if(key==='candidateTree'){
          //   target=gPopupModifyHarvest.hierarchyTree;
          // }
          // target.filter(val);
        });

        // $("#datetime-local-customizard").datetimepicker();

        $('#btn-bulk-import-submit').on('click', function(e){
          var step=$(this).attr('step');
          if (step==='0') {
            gPopupModifyHarvest.processorModify.bulkImportStep0();            
          }else{
            gPopupModifyHarvest.processorModify.bulkImportStep1();
          }
        });

        $("#a-link-summary").trigger('click');
    });

    
    function useTargetURL(){
      var url=$("#specifyTargetUrlInput").val();
      $('#importFromUrlInput').val(url);
    }

    function openBulkImportSchemaFile(){
      // $("#label-bulk-import-file").trigger('click');
      $("#bulkImportMetadataFile").trigger('click');
    }
</script>
</body>